(function() {
  var AutoComplete, fs, helpers, os, path, uuid;

  fs = require('fs-plus');

  path = require('path');

  os = require('os');

  uuid = require('node-uuid');

  helpers = require('./spec-helper');

  AutoComplete = require('../lib/autocomplete');

  describe("autocomplete functionality", function() {
    beforeEach(function() {
      this.autoComplete = new AutoComplete(['taba', 'tabb', 'tabc']);
      this.testDir = path.join(os.tmpdir(), "atom-ex-mode-spec-" + (uuid.v4()));
      this.nonExistentTestDir = path.join(os.tmpdir(), "atom-ex-mode-spec-" + (uuid.v4()));
      this.testFile1 = path.join(this.testDir, "atom-ex-testfile-a.txt");
      this.testFile2 = path.join(this.testDir, "atom-ex-testfile-b.txt");
      return runs((function(_this) {
        return function() {
          fs.makeTreeSync(_this.testDir);
          fs.closeSync(fs.openSync(_this.testFile1, 'w'));
          fs.closeSync(fs.openSync(_this.testFile2, 'w'));
          spyOn(_this.autoComplete, 'resetCompletion').andCallThrough();
          spyOn(_this.autoComplete, 'getFilePathCompletion').andCallThrough();
          return spyOn(_this.autoComplete, 'getCommandCompletion').andCallThrough();
        };
      })(this));
    });
    afterEach(function() {
      return fs.removeSync(this.testDir);
    });
    describe("autocomplete commands", function() {
      beforeEach(function() {
        return this.completed = this.autoComplete.getAutocomplete('tab');
      });
      it("returns taba", function() {
        return expect(this.completed).toEqual('taba');
      });
      return it("calls command function", function() {
        return expect(this.autoComplete.getCommandCompletion.callCount).toBe(1);
      });
    });
    describe("autocomplete commands, then autoComplete again", function() {
      beforeEach(function() {
        this.completed = this.autoComplete.getAutocomplete('tab');
        return this.completed = this.autoComplete.getAutocomplete('tab');
      });
      it("returns tabb", function() {
        return expect(this.completed).toEqual('tabb');
      });
      return it("calls command function", function() {
        return expect(this.autoComplete.getCommandCompletion.callCount).toBe(1);
      });
    });
    describe("autocomplete directory", function() {
      beforeEach(function() {
        var filePath;
        filePath = path.join(os.tmpdir(), 'atom-ex-mode-spec-');
        return this.completed = this.autoComplete.getAutocomplete('tabe ' + filePath);
      });
      it("returns testDir", function() {
        var expected;
        expected = 'tabe ' + this.testDir + path.sep;
        return expect(this.completed).toEqual(expected);
      });
      return it("clears autocomplete", function() {
        return expect(this.autoComplete.resetCompletion.callCount).toBe(1);
      });
    });
    describe("autocomplete directory, then autocomplete again", function() {
      beforeEach(function() {
        var filePath;
        filePath = path.join(os.tmpdir(), 'atom-ex-mode-spec-');
        this.completed = this.autoComplete.getAutocomplete('tabe ' + filePath);
        return this.completed = this.autoComplete.getAutocomplete(this.completed);
      });
      it("returns test file 1", function() {
        return expect(this.completed).toEqual('tabe ' + this.testFile1);
      });
      return it("lists files twice", function() {
        return expect(this.autoComplete.getFilePathCompletion.callCount).toBe(2);
      });
    });
    describe("autocomplete full directory, then autocomplete again", function() {
      beforeEach(function() {
        var filePath;
        filePath = path.join(this.testDir, 'a');
        this.completed = this.autoComplete.getAutocomplete('tabe ' + filePath);
        return this.completed = this.autoComplete.getAutocomplete(this.completed);
      });
      it("returns test file 2", function() {
        return expect(this.completed).toEqual('tabe ' + this.testFile2);
      });
      return it("lists files once", function() {
        return expect(this.autoComplete.getFilePathCompletion.callCount).toBe(1);
      });
    });
    describe("autocomplete non existent directory", function() {
      beforeEach(function() {
        return this.completed = this.autoComplete.getAutocomplete('tabe ' + this.nonExistentTestDir);
      });
      return it("returns no completions", function() {
        var expected;
        expected = '';
        return expect(this.completed).toEqual(expected);
      });
    });
    return describe("autocomplete existing file as directory", function() {
      beforeEach(function() {
        var filePath;
        filePath = this.testFile1 + path.sep;
        return this.completed = this.autoComplete.getAutocomplete('tabe ' + filePath);
      });
      return it("returns no completions", function() {
        var expected;
        expected = '';
        return expect(this.completed).toEqual(expected);
      });
    });
  });

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiL2hvbWUvamF6ei8uYXRvbS9wYWNrYWdlcy9leC1tb2RlL3NwZWMvYXV0b2NvbXBsZXRlLXNwZWMuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUEsTUFBQTs7RUFBQSxFQUFBLEdBQUssT0FBQSxDQUFRLFNBQVI7O0VBQ0wsSUFBQSxHQUFPLE9BQUEsQ0FBUSxNQUFSOztFQUNQLEVBQUEsR0FBSyxPQUFBLENBQVEsSUFBUjs7RUFDTCxJQUFBLEdBQU8sT0FBQSxDQUFRLFdBQVI7O0VBRVAsT0FBQSxHQUFVLE9BQUEsQ0FBUSxlQUFSOztFQUNWLFlBQUEsR0FBZSxPQUFBLENBQVEscUJBQVI7O0VBRWYsUUFBQSxDQUFTLDRCQUFULEVBQXVDLFNBQUE7SUFDckMsVUFBQSxDQUFXLFNBQUE7TUFDVCxJQUFDLENBQUEsWUFBRCxHQUFnQixJQUFJLFlBQUosQ0FBaUIsQ0FBQyxNQUFELEVBQVMsTUFBVCxFQUFpQixNQUFqQixDQUFqQjtNQUNoQixJQUFDLENBQUEsT0FBRCxHQUFXLElBQUksQ0FBQyxJQUFMLENBQVUsRUFBRSxDQUFDLE1BQUgsQ0FBQSxDQUFWLEVBQXVCLG9CQUFBLEdBQW9CLENBQUMsSUFBSSxDQUFDLEVBQUwsQ0FBQSxDQUFELENBQTNDO01BQ1gsSUFBQyxDQUFBLGtCQUFELEdBQXNCLElBQUksQ0FBQyxJQUFMLENBQVUsRUFBRSxDQUFDLE1BQUgsQ0FBQSxDQUFWLEVBQXVCLG9CQUFBLEdBQW9CLENBQUMsSUFBSSxDQUFDLEVBQUwsQ0FBQSxDQUFELENBQTNDO01BQ3RCLElBQUMsQ0FBQSxTQUFELEdBQWEsSUFBSSxDQUFDLElBQUwsQ0FBVSxJQUFDLENBQUEsT0FBWCxFQUFvQix3QkFBcEI7TUFDYixJQUFDLENBQUEsU0FBRCxHQUFhLElBQUksQ0FBQyxJQUFMLENBQVUsSUFBQyxDQUFBLE9BQVgsRUFBb0Isd0JBQXBCO2FBRWIsSUFBQSxDQUFLLENBQUEsU0FBQSxL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cmVxdWlyZSAnZnMtcGx1cydcbnBhdGggPSByZXF1aXJlICdwYXRoJ1xub3MgPSByZXF1aXJlICdvcydcbnV1aWQgPSByZXF1aXJlICdub2RlLXV1aWQnXG5cbmhlbHBlcnMgPSByZXF1aXJlICcuL3NwZWMtaGVscGVyJ1xuQXV0b0NvbXBsZXRlID0gcmVxdWlyZSAnLi4vbGliL2F1dG9jb21wbGV0ZSdcblxuZGVzY3JpYmUgXCJhdXRvY29tcGxldGUgZnVuY3Rpb25hbGl0eVwiLCAtPlxuICBiZWZvcmVFYWNoIC0+XG4gICAgQGF1dG9Db21wbGV0ZSA9IG5ldyBBdXRvQ29tcGxldGUoWyd0YWJhJywgJ3RhYmInLCAndGFiYyddKVxuICAgIEB0ZXN0RGlyID0gcGF0aC5qb2luKG9zLnRtcGRpcigpLCBcImF0b20tZXgtbW9kZS1zcGVjLSN7dXVpZC52NCgpfVwiKVxuICAgIEBub25FeGlzdGVudFRlc3REaXIgPSBwYXRoLmpvaW4ob3MudG1wZGlyKCksIFwiYXRvbS1leC1tb2RlLXNwZWMtI3t1dWlkLnY0KCl9XCIpXG4gICAgQHRlc3RGaWxlMSA9IHBhdGguam9pbihAdGVzdERpciwgXCJhdG9tLWV4LXRlc3RmaWxlLWEudHh0XCIpXG4gICAgQHRlc3RGaWxlMiA9IHBhdGguam9pbihAdGVzdERpciwgXCJhdG9tLWV4LXRlc3RmaWxlLWIudHh0XCIpXG5cbiAgICBydW5zID0+XG4gICAgICBmcy5tYWtlVHJlZVN5bmMoQHRlc3REaXIpXG4gICAgICBmcy5jbG9zZVN5bmMoZnMub3BlblN5bmMoQHRlc3RGaWxlMSwgJ3cnKSk7XG4gICAgICBmcy5jbG9zZVN5bmMoZnMub3BlblN5bmMoQHRlc3RGaWxlMiwgJ3cnKSk7XG4gICAgICBzcHlPbihAYXV0b0NvbXBsZXRlLCAncmVzZXRDb21wbGV0aW9uJykuYW5kQ2FsbFRocm91Z2goKVxuICAgICAgc3B5T24oQGF1dG9Db21wbGV0ZSwgJ2dldEZpbGVQYXRoQ29tcGxldGlvbicpLmFuZENhbGxUaHJvdWdoKClcbiAgICAgIHNweU9uKEBhdXRvQ29tcGxldGUsICdnZXRDb21tYW5kQ29tcGxldGlvbicpLmFuZENhbGxUaHJvdWdoKClcblxuICBhZnRlckVhY2ggLT5cbiAgICBmcy5yZW1vdmVTeW5jKEB0ZXN0RGlyKVxuXG4gIGRlc2NyaWJlIFwiYXV0b2NvbXBsZXRlIGNvbW1hbmRzXCIsIC0+XG4gICAgYmVmb3JlRWFjaCAtPlxuICAgICAgQGNvbXBsZXRlZCA9IEBhdXRvQ29tcGxldGUuZ2V0QXV0b2NvbXBsZXRlKCd0YWInKVxuXG4gICAgaXQgXCJyZXR1cm5zIHRhYmFcIiwgLT5cbiAgICAgIGV4cGVjdChAY29tcGxldGVkKS50b0VxdWFsKCd0YWJhJylcblxuICAgIGl0IFwiY2FsbHMgY29tbWFuZCBmdW5jdGlvblwiLCAtPlxuICAgICAgZXhwZWN0KEBhdXRvQ29tcGxldGUuZ2V0Q29tbWFuZENvbXBsZXRpb24uY2FsbENvdW50KS50b0JlKDEpXG5cbiAgZGVzY3JpYmUgXCJhdXRvY29tcGxldGUgY29tbWFuZHMsIHRoZW4gYXV0b0NvbXBsZXRlIGFnYWluXCIsIC0+XG4gICAgYmVmb3JlRWFjaCAtPlxuICAgICAgQGNvbXBsZXRlZCA9IEBhdXRvQ29tcGxldGUuZ2V0QXV0b2NvbXBsZXRlKCd0YWInKVxuICAgICAgQGNvbXBsZXRlZCA9IEBhdXRvQ29tcGxldGUuZ2V0QXV0b2NvbXBsZXRlKCd0YWInKVxuXG4gICAgaXQgXCJyZXR1cm5zIHRhYmJcIiwgLT5cbiAgICAgIGV4cGVjdChAY29tcGxldGVkKS50b0VxdWFsKCd0YWJiJylcblxuICAgIGl0IFwiY2FsbHMgY29tbWFuZCBmdW5jdGlvblwiLCAtPlxuICAgICAgZXhwZWN0KEBhdXRvQ29tcGxldGUuZ2V0Q29tbWFuZENvbXBsZXRpb24uY2FsbENvdW50KS50b0JlKDEpXG5cbiAgZGVzY3JpYmUgXCJhdXRvY29tcGxldGUgZGlyZWN0b3J5XCIsIC0+XG4gICAgYmVmb3JlRWFjaCAtPlxuICAgICAgZmlsZVBhdGggPSBwYXRoLmpvaW4ob3MudG1wZGlyKCksICdhdG9tLWV4LW1vZGUtc3BlYy0nKVxuICAgICAgQGNvbXBsZXRlZCA9IEBhdXRvQ29tcGxldGUuZ2V0QXV0b2NvbXBsZXRlKCd0YWJlICcgKyBmaWxlUGF0aClcblxuICAgIGl0IFwicmV0dXJucyB0ZXN0RGlyXCIsIC0+XG4gICAgICBleHBlY3RlZCA9ICd0YWJlICcgKyBAdGVzdERpciArIHBhdGguc2VwXG4gICAgICBleHBlY3QoQGNvbXBsZXRlZCkudG9FcXVhbChleHBlY3RlZClcblxuICAgIGl0IFwiY2xlYXJzIGF1dG9jb21wbGV0ZVwiLCAtPlxuICAgICAgZXhwZWN0KEBhdXRvQ29tcGxldGUucmVzZXRDb21wbGV0aW9uLmNhbGxDb3VudCkudG9CZSgxKVxuXG4gIGRlc2NyaWJlIFwiYXV0b2NvbXBsZXRlIGRpcmVjdG9yeSwgdGhlbiBhdXRvY29tcGxldGUgYWdhaW5cIiwgLT5cbiAgICBiZWZvcmVFYWNoIC0+XG4gICAgICBmaWxlUGF0aCA9IHBhdGguam9pbihvcy50bXBkaXIoKSwgJ2F0b20tZXgtbW9kZS1zcGVjLScpXG4gICAgICBAY29tcGxldGVkID0gQGF1dG9Db21wbGV0ZS5nZXRBdXRvY29tcGxldGUoJ3RhYmUgJyArIGZpbGVQYXRoKVxuICAgICAgQGNvbXBsZXRlZCA9IEBhdXRvQ29tcGxldGUuZ2V0QXV0b2NvbXBsZXRlKEBjb21wbGV0ZWQpXG5cbiAgICBpdCBcInJldHVybnMgdGVzdCBmaWxlIDFcIiwgLT5cbiAgICAgIGV4cGVjdChAY29tcGxldGVkKS50b0VxdWFsKCd0YWJlICcgKyBAdGVzdEZpbGUxKVxuXG4gICAgaXQgXCJsaXN0cyBmaWxlcyB0d2ljZVwiLCAtPlxuICAgICAgZXhwZWN0KEBhdXRvQ29tcGxldGUuZ2V0RmlsZVBhdGhDb21wbGV0aW9uLmNhbGxDb3VudCkudG9CZSgyKVxuXG4gIGRlc2NyaWJlIFwiYXV0b2NvbXBsZXRlIGZ1bGwgZGlyZWN0b3J5LCB0aGVuIGF1dG9jb21wbGV0ZSBhZ2FpblwiLCAtPlxuICAgIGJlZm9yZUVhY2ggLT5cbiAgICAgIGZpbGVQYXRoID0gcGF0aC5qb2luKEB0ZXN0RGlyLCAnYScpXG4gICAgICBAY29tcGxldGVkID0gQGF1dG9Db21wbGV0ZS5nZXRBdXRvY29tcGxldGUoJ3RhYmUgJyArIGZpbGVQYXRoKVxuICAgICAgQGNvbXBsZXRlZCA9IEBhdXRvQ29tcGxldGUuZ2V0QXV0b2NvbXBsZXRlKEBjb21wbGV0ZWQpXG5cbiAgICBpdCBcInJldHVybnMgdGVzdCBmaWxlIDJcIiwgLT5cbiAgICAgIGV4cGVjdChAY29tcGxldGVkKS50b0VxdWFsKCd0YWJlICcgKyBAdGVzdEZpbGUyKVxuXG4gICAgaXQgXCJsaXN0cyBmaWxlcyBvbmNlXCIsIC0+XG4gICAgICBleHBlY3QoQGF1dG9Db21wbGV0ZS5nZXRGaWxlUGF0aENvbXBsZXRpb24uY2FsbENvdW50KS50b0JlKDEpXG5cbiAgZGVzY3JpYmUgXCJhdXRvY29tcGxldGUgbm9uIGV4aXN0ZW50IGRpcmVjdG9yeVwiLCAtPlxuICAgIGJlZm9yZUVhY2ggLT5cbiAgICAgIEBjb21wbGV0ZWQgPSBAYXV0b0NvbXBsZXRlLmdldEF1dG9jb21wbGV0ZSgndGFiZSAnICsgQG5vbkV4aXN0ZW50VGVzdERpcilcblxuICAgIGl0IFwicmV0dXJucyBubyBjb21wbGV0aW9uc1wiLCAtPlxuICAgICAgZXhwZWN0ZWQgPSAnJztcbiAgICAgIGV4cGVjdChAY29tcGxldGVkKS50b0VxdWFsKGV4cGVjdGVkKVxuXG4gIGRlc2NyaWJlIFwiYXV0b2NvbXBsZXRlIGV4aXN0aW5nIGZpbGUgYXMgZGlyZWN0b3J5XCIsIC0+XG4gICAgYmVmb3JlRWFjaCAtPlxuICAgICAgZmlsZVBhdGggPSBAdGVzdEZpbGUxICsgcGF0aC5zZXBcbiAgICAgIEBjb21wbGV0ZWQgPSBAYXV0b0NvbXBsZXRlLmdldEF1dG9jb21wbGV0ZSgndGFiZSAnICsgZmlsZVBhdGgpXG5cbiAgICBpdCBcInJldHVybnMgbm8gY29tcGxldGlvbnNcIiwgLT5cbiAgICAgIGV4cGVjdGVkID0gJyc7XG4gICAgICBleHBlY3QoQGNvbXBsZXRlZCkudG9FcXVhbChleHBlY3RlZClcbiJdfQ==
